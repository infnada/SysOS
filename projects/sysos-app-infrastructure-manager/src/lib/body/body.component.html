<div class="window__body" [ngClass]="{'with_status': application.status, 'with_actions': application.actions}">
  <div class="window__side" *ngIf="viewSide">

    <mat-tree [dataSource]="dataSource" [treeControl]="treeControl">
      <!-- This is the tree node template for leaf nodes -->
      <mat-tree-node *matTreeNodeDef="let node" matTreeNodePadding matTreeNodePaddingIndent="10" (contextmenu)="onTreeContextMenu($event, node)">
        <!-- use a disabled button to provide padding for tree leaf -->
        <button mat-icon-button disabled></button>

        <ng-container *ngIf="node.type === 'standalone'"><span><i class="mr-1 text-primary fa fa-folder"></i> {{node.name}}</span></ng-container>
        <ng-container *ngIf="node.type === 'linux'"><span><i class="mr-1 text-primary fa fa-linux"></i> {{node.name}}</span></ng-container>
        <ng-container *ngIf="node.type === 'windows'"><span><i class="mr-1 text-primary fa fa-windows"></i> {{node.name}}</span></ng-container>
        <ng-container *ngIf="node.type === 'snmp'"><span><i class="mr-1 text-primary fa fa-desktop"></i> {{node.name}}</span></ng-container>

        <ng-container *ngIf="node.type === 'storage'"><span><i class="mr-1 text-primary fa fa-database"></i> {{node.name}}</span></ng-container>
        <ng-container *ngIf="node.type === 'netapp'"><span (click)="setActiveView('netapp', node);"><img src="/assets/img/NetApp-logo.png" width="16px" class="mr-1" /> {{node.name}}</span></ng-container>
        <ng-container *ngIf="node.type === 'vserver'"><span (click)="setActiveView('netapp-vserver', node);"><i class="mr-1 fa fa-server"></i> {{node.name}}</span></ng-container>
        <ng-container *ngIf="node.type === 'volume'"><span (click)="setActiveView('netapp-volume', node);"><i class="vs-icon vsphere-icon-datastore"></i> {{node.name}}</span></ng-container>
        <ng-container *ngIf="node.type === 'snapshot'"><span (click)="setActiveView('netapp-snapshot', node);"><i class="mr-1 fa fa-camera"></i> {{node.name}}</span></ng-container>
        <ng-container *ngIf="node.type === 'virtual'"><span><i class="mr-1 text-primary fa fa-cloud"></i> {{node.name}}</span></ng-container>
        <ng-container *ngIf="node.type === 'vmware'"><span (click)="setActiveView('vmware', node);"><i class="vs-icon vsphere-icon-vcenter"></i> {{node.name}}</span></ng-container>
        <ng-container *ngIf="node.type === 'Datacenter'"><span (click)="setActiveView('vmware-datacenter', node);"><i class="vs-icon vsphere-icon-datacenter"></i> {{node.name}}</span></ng-container>
        <ng-container *ngIf="node.type === 'ClusterComputeResource'"><span (click)="setActiveView('vmware-cluster', node);"><i class="vs-icon vsphere-icon-cluster"></i> {{node.name}}</span></ng-container>
        <ng-container *ngIf="node.type === 'HostSystem'"><span (click)="setActiveView('vmware-host', node);"><i class="vs-icon" [ngClass]="{'vsphere-icon-host-disconnected': node.info.data.runtime.powerState === 'poweredOff', 'vsphere-icon-host': node.info.data.runtime.powerState === 'poweredOn'}"></i> {{node.name}}</span></ng-container>
        <ng-container *ngIf="node.type === 'Folder'"><span (click)="setActiveView('vmware-folder', node);"><i class="vs-icon vsphere-icon-folder"></i> {{node.name}}</span></ng-container>
        <ng-container *ngIf="node.type === 'ResourcePool'"><span (click)="setActiveView('vmware-resource-pool', node);"><i class="vs-icon vsphere-icon-resource-pool"></i> {{node.name}}</span></ng-container>
        <ng-container *ngIf="node.type === 'VirtualApp'"><span (click)="setActiveView('vmware-virtual-app', node);"><i class="vs-icon vsphere-icon-vapp"></i> {{node.name}}</span></ng-container>
        <ng-container *ngIf="node.type === 'VirtualMachine'"><span (click)="setActiveView('vmware-virtual-machine', node);"><i class="vs-icon" [ngClass]="{'vsphere-icon-vm': node.info.data['runtime.powerState'] === 'poweredOff', 'vsphere-icon-vm-on': node.info.data['runtime.powerState'] === 'poweredOn', 'vsphere-icon-vm-suspended': node.info.data['runtime.powerState'] === 'suspended', 'vsphere-icon-vm-error': node.info.data['runtime.connectionState'] === 'inaccessible'}"></i> {{node.name}}</span></ng-container>
        <ng-container *ngIf="node.type === 'StoragePod'"><span (click)="setActiveView('vmware-storage-pod', node);"><i class="vs-icon vsphere-icon-datastore-cluster"></i> {{node.name}}</span></ng-container>
        <ng-container *ngIf="node.type === 'Datastore'"><span (click)="setActiveView('vmware-datastore', node);"><i class="vs-icon" [ngClass]="{'vsphere-icon-datastore': node.info.data['summary.accessible'] === 'true', 'vsphere-icon-datastore-inaccessible': node.info.data['summary.accessible'] === 'false'}"></i> {{node.name}}</span></ng-container>

        <div style="position: fixed"
             [style.left]="contextMenuPosition.x"
             [style.top]="contextMenuPosition.y"
             [matMenuTriggerFor]="contextMenuTree"
             [matMenuTriggerData]="{item: node}">
        </div>
      </mat-tree-node>
      <!-- This is the tree node template for expandable nodes -->
      <mat-tree-node *matTreeNodeDef="let node;when: hasChild" matTreeNodePadding matTreeNodePaddingIndent="10" (contextmenu)="onTreeContextMenu($event, node)">
        <button mat-icon-button matTreeNodeToggle [attr.aria-label]="'toggle ' + node.name">
          <mat-icon class="mat-icon-rtl-mirror">
            {{treeControl.isExpanded(node) ? 'expand_more' : 'chevron_right'}}
          </mat-icon>
        </button>

        <ng-container *ngIf="node.type === 'standalone'"><span><i class="mr-1 text-primary fa fa-folder"></i> {{node.name}}</span></ng-container>
        <ng-container *ngIf="node.type === 'linux'"><span><i class="mr-1 text-primary fa fa-linux"></i> {{node.name}}</span></ng-container>
        <ng-container *ngIf="node.type === 'windows'"><span><i class="mr-1 text-primary fa fa-windows"></i> {{node.name}}</span></ng-container>
        <ng-container *ngIf="node.type === 'snmp'"><span><i class="mr-1 text-primary fa fa-desktop"></i> {{node.name}}</span></ng-container>

        <ng-container *ngIf="node.type === 'storage'"><span><i class="mr-1 text-primary fa fa-database"></i> {{node.name}}</span></ng-container>
        <ng-container *ngIf="node.type === 'netapp'"><span (click)="setActiveView('netapp', node);"><img src="/assets/img/NetApp-logo.png" width="16px" class="mr-1" /> {{node.name}}</span></ng-container>
        <ng-container *ngIf="node.type === 'vserver'"><span (click)="setActiveView('netapp-vserver', node);"><i class="mr-1 fa fa-server"></i> {{node.name}}</span></ng-container>
        <ng-container *ngIf="node.type === 'volume'"><span (click)="setActiveView('netapp-volume', node);"><i class="vs-icon vsphere-icon-datastore"></i> {{node.name}}</span></ng-container>
        <ng-container *ngIf="node.type === 'snapshot'"><span (click)="setActiveView('netapp-snapshot', node);"><i class="mr-1 fa fa-camera"></i> {{node.name}}</span></ng-container>
        <ng-container *ngIf="node.type === 'virtual'"><span><i class="mr-1 text-primary fa fa-cloud"></i> {{node.name}}</span></ng-container>
        <ng-container *ngIf="node.type === 'vmware'"><span (click)="setActiveView('vmware', node);"><i class="vs-icon vsphere-icon-vcenter"></i> {{node.name}}</span></ng-container>
        <ng-container *ngIf="node.type === 'Datacenter'"><span (click)="setActiveView('vmware-datacenter', node);"><i class="vs-icon vsphere-icon-datacenter"></i> {{node.name}}</span></ng-container>
        <ng-container *ngIf="node.type === 'ClusterComputeResource'"><span (click)="setActiveView('vmware-cluster', node);"><i class="vs-icon vsphere-icon-cluster"></i> {{node.name}}</span></ng-container>
        <ng-container *ngIf="node.type === 'HostSystem'"><span (click)="setActiveView('vmware-host', node);"><i class="vs-icon" [ngClass]="{'vsphere-icon-host-disconnected': node.info.data.runtime.powerState === 'poweredOff', 'vsphere-icon-host': node.info.data.runtime.powerState === 'poweredOn'}"></i> {{node.name}}</span></ng-container>
        <ng-container *ngIf="node.type === 'Folder'"><span (click)="setActiveView('vmware-folder', node);"><i class="vs-icon vsphere-icon-folder"></i> {{node.name}}</span></ng-container>
        <ng-container *ngIf="node.type === 'ResourcePool'"><span (click)="setActiveView('vmware-resource-pool', node);"><i class="vs-icon vsphere-icon-resource-pool"></i> {{node.name}}</span></ng-container>
        <ng-container *ngIf="node.type === 'VirtualApp'"><span (click)="setActiveView('vmware-virtual-app', node);"><i class="vs-icon vsphere-icon-vapp"></i> {{node.name}}</span></ng-container>
        <ng-container *ngIf="node.type === 'VirtualMachine'"><span (click)="setActiveView('vmware-virtual-machine', node);"><i class="vs-icon" [ngClass]="{'vsphere-icon-vm': node.info.data['runtime.powerState'] === 'poweredOff', 'vsphere-icon-vm-on': node.info.data['runtime.powerState'] === 'poweredOn', 'vsphere-icon-vm-suspended': node.info.data['runtime.powerState'] === 'suspended', 'vsphere-icon-vm-error': node.info.data['runtime.connectionState'] === 'inaccessible'}"></i> {{node.name}}</span></ng-container>
        <ng-container *ngIf="node.type === 'StoragePod'"><span (click)="setActiveView('vmware-storage-pod', node);"><i class="vs-icon vsphere-icon-datastore-cluster"></i> {{node.name}}</span></ng-container>
        <ng-container *ngIf="node.type === 'Datastore'"><span (click)="setActiveView('vmware-datastore', node);"><i class="vs-icon" [ngClass]="{'vsphere-icon-datastore': node.info.data['summary.accessible'] === 'true', 'vsphere-icon-datastore-inaccessible': node.info.data['summary.accessible'] === 'false'}"></i> {{node.name}}</span></ng-container>

        <div style="position: fixed"
             [style.left]="contextMenuPosition.x"
             [style.top]="contextMenuPosition.y"
             [matMenuTriggerFor]="contextMenuTree"
             [matMenuTriggerData]="{item: node}">
        </div>
      </mat-tree-node>

      <mat-menu #contextMenuTree="matMenu">
        <ng-template matMenuContent let-item="item">
          <ng-container *ngFor="let menuItem of treeContextMenuItems(item)">

            <!-- Item has submenu -->
            <ng-container *ngIf="menuItem.subMenu">
              <mat-menu #contextSubMenuTree="matMenu">
                <ng-template matMenuContent let-subItem="subItem" let-subMenu="subMenu">
                  <ng-container *ngFor="let menuItemSub of subMenu">

                    <button mat-menu-item *ngIf="menuItemSub.text !== 'divider'" (click)="menuItemSub.action(subItem)" [disabled]="checkIfDisabled(menuItemSub)" [innerHTML]="contextToText(menuItemSub)"></button>

                    <mat-divider *ngIf="menuItemSub.text === 'divider'"></mat-divider>
                  </ng-container>
                </ng-template>
              </mat-menu>

              <button mat-menu-item [matMenuTriggerFor]="contextSubMenuTree" [matMenuTriggerData]="{subItem: item, subMenu: menuItem.subMenu}" *ngIf="menuItem.text !== 'divider'" (click)="menuItem.action(item)" [disabled]="checkIfDisabled(menuItem)" [innerHTML]="contextToText(menuItem)"></button>
            </ng-container>
            <!-- End submenu -->

            <ng-container *ngIf="!menuItem.subMenu">
              <button mat-menu-item *ngIf="menuItem.text !== 'divider'" (click)="menuItem.action(item)" [disabled]="checkIfDisabled(menuItem)" [innerHTML]="contextToText(menuItem)"></button>
            </ng-container>

            <mat-divider *ngIf="menuItem.text === 'divider'"></mat-divider>
          </ng-container>
        </ng-template>
      </mat-menu>

    </mat-tree>

    <div class="secondary-content__new__box__toggle pointer visible-lg">
      <div class="secondary-content__new__box__toggle__slide" (click)="toggleSide()">
        <i class="fa fa-arrow-left sidebar-open-font open-sidebar"></i>
      </div>
    </div>
  </div>
  <div class="secondary-content__new__box__toggle toggle_left pointer visible-lg" *ngIf="!viewSide" (click)="toggleSide()">
    <i class="fa fa-arrow-right sidebar-open-font open-sidebar"></i>
  </div>
  <div class="window__main">
    <div class="col">
      <saim-body-new-connection [application]="application" *ngIf="activeConnection === null || getActiveConnection().state === 'disconnected'"></saim-body-new-connection>

      <saim-body-vmware *ngIf="activeView.type === 'vmware'"></saim-body-vmware>
      <saim-body-vmware-datacenter *ngIf="activeView.type === 'vmware-datacenter'"></saim-body-vmware-datacenter>
      <saim-body-vmware-cluster *ngIf="activeView.type === 'vmware-cluster'"></saim-body-vmware-cluster>
      <saim-body-vmware-host *ngIf="activeView.type === 'vmware-host'"></saim-body-vmware-host>
      <saim-body-vmware-folder *ngIf="activeView.type === 'vmware-folder'"></saim-body-vmware-folder>
      <saim-body-vmware-resource-pool *ngIf="activeView.type === 'vmware-resource-pool'"></saim-body-vmware-resource-pool>
      <saim-body-vmware-virtual-app *ngIf="activeView.type === 'vmware-virtual-app'"></saim-body-vmware-virtual-app>
      <saim-body-vmware-virtual-machine *ngIf="activeView.type === 'vmware-virtual-machine'"></saim-body-vmware-virtual-machine>
      <saim-body-vmware-storage-pod *ngIf="activeView.type === 'vmware-storage-pod'"></saim-body-vmware-storage-pod>
      <saim-body-vmware-datastore *ngIf="activeView.type === 'vmware-datastore'"></saim-body-vmware-datastore>

      <saim-body-netapp *ngIf="activeView.type === 'netapp'"></saim-body-netapp>
      <saim-body-netapp-vserver *ngIf="activeView.type === 'netapp-vserver'"></saim-body-netapp-vserver>
      <saim-body-netapp-volume *ngIf="activeView.type === 'netapp-volume'"></saim-body-netapp-volume>
      <saim-body-netapp-snapshot *ngIf="activeView.type === 'netapp-snapshot'"></saim-body-netapp-snapshot>
    </div>

    <!--<div ng-if="smB.showvCenter == true">
	  <div ng-include="'templates/applications/vcenter-type-smanager.html'" include-replace></div>
	</div>
	<div ng-if="smB.showSnapshot == true">
	  <div ng-include="'templates/applications/snapshot-type-smanager.html'" include-replace></div>
	</div>
	<div ng-if="smB.showVm == true || smB.showStandalone == true && smB.getActiveConnection().state != 'disconnected' && smB.getActiveConnection().so != 'snmp'">
	  <div ng-include="'templates/applications/standalone-type-smanager.html'" include-replace></div>
	</div>
	<div ng-if="smB.getActiveConnection().so == 'snmp'">
	  <div ng-include="'templates/applications/snmp-type-smanager.html'" include-replace></div>
	</div>
	<div ng-if="smB.showNewConnectionType == true">
	  <div ng-include="'templates/applications/new-connection-type-smanager.html'" include-replace></div>
	</div>
	<div ng-if="smB.showNewConnection == true || smB.getActiveConnection().state == 'disconnected'">
	  <div ng-include="'templates/applications/new-connection-smanager.html'" include-replace></div>
	</div>
	<div ng-if="smB.showConfigureConnection == true">
	  <div ng-include="'templates/applications/configure-connection-smanager.html'" include-replace></div>
	</div>-->
  </div>
</div>
